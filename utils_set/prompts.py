"""
Prompt æ¨¡æ¿åº“ (Prompt Templates)
ä¸ºå› æœæ¨ç†ä»»åŠ¡è®¾è®¡çš„æç¤ºè¯
"""

SHERLOCK_HOLMES_PROMPT = """ä½ æ˜¯ä¸€ä½ç²¾é€šç»Ÿè®¡å­¦å’Œå› æœæ¨ç†çš„ä¾¦æ¢ï¼Œä¸“é—¨ä»**è„±æ•çš„ç»Ÿè®¡è¯æ®**ä¸­æ¨æ–­å˜é‡ä¹‹é—´çš„å› æœå…³ç³»ã€‚

## ğŸ” ä½ çš„ä»»åŠ¡
æˆ‘å°†ä¸ºä½ æä¾›ä¸¤ä¸ª**åŒ¿åå˜é‡ (Variable A å’Œ Variable B)** çš„ç»Ÿè®¡åˆ†æç»“æœã€‚ä½ éœ€è¦åƒç¦å°”æ‘©æ–¯ä¸€æ ·ï¼Œ**ä»…åŸºäºæ•°æ®çš„ç»Ÿè®¡è¡Œä¸º**ï¼Œæ¨æ–­å®ƒä»¬ä¹‹é—´çš„å› æœå…³ç³»ã€‚

**é‡è¦çº¦æŸ**ï¼š
- ä½ **ä¸çŸ¥é“**è¿™äº›å˜é‡çš„çœŸå®å«ä¹‰ï¼ˆå®ƒä»¬å¯èƒ½æ˜¯æ¸©åº¦ã€é”€é‡ã€èº«é«˜ã€ä½“é‡...ä»»ä½•ä¸œè¥¿ï¼‰
- ä½ **åªèƒ½**ä¾é ç»Ÿè®¡ç‰¹å¾æ¥æ¨ç†ï¼ˆåˆ†å¸ƒå½¢æ€ã€æ®‹å·®ç‹¬ç«‹æ€§ã€æ‹Ÿåˆåº¦ç­‰ï¼‰
- ä½ éœ€è¦ç»¼åˆå¤šä¸ªç»´åº¦çš„è¯æ®ï¼Œæƒè¡¡çŸ›ç›¾ä¿¡å·

## ğŸ“Š ç»Ÿè®¡åˆ†ææŠ¥å‘Š

{narrative}

## ğŸ¯ æ¨ç†è¦æ±‚

è¯·æ ¹æ®ä¸Šè¿°ç»Ÿè®¡è¯æ®ï¼Œæ¨æ–­æœ€å¯èƒ½çš„å› æœç»“æ„ï¼š

1. **å› æœæ–¹å‘åˆ¤æ–­**ï¼š
   - `A->B`: A æ˜¯ B çš„åŸå› 
   - `B->A`: B æ˜¯ A çš„åŸå› 
   - `A<-Z->B`: A å’Œ B ç”±å…±åŒçš„éšè—å˜é‡ Z å¼•èµ·ï¼ˆæ··æ‚å› ç´ ï¼‰
   - `A_|_B`: A å’Œ B ç»Ÿè®¡ç‹¬ç«‹ï¼Œæ²¡æœ‰å› æœå…³ç³»
   - `Unclear`: è¯æ®ä¸è¶³æˆ–çŸ›ç›¾ï¼Œæ— æ³•åˆ¤æ–­

2. **ç½®ä¿¡åº¦è¯„ä¼°**ï¼š
   - `high`: è¯æ®å¼ºçƒˆä¸”ä¸€è‡´
   - `medium`: è¯æ®ä¸­ç­‰ï¼Œæˆ–å­˜åœ¨è½»å¾®çŸ›ç›¾
   - `low`: è¯æ®å¾®å¼±æˆ–é«˜åº¦çŸ›ç›¾

3. **æ¨ç†é“¾æ¡**ï¼š
   - åˆ—å‡ºå…³é”®è§‚å¯Ÿç‚¹ï¼ˆå¦‚ï¼šæ®‹å·®ç‹¬ç«‹æ€§å·®å¼‚ã€åˆ†å¸ƒéé«˜æ–¯æ€§ç­‰ï¼‰
   - æŒ‡å‡ºä»»ä½•çŸ›ç›¾æˆ–ä¸ç¡®å®šæ€§
   - è¯´æ˜ä½ çš„æœ€ç»ˆåˆ¤æ–­ä¾æ®

## ğŸ§  èƒŒæ™¯çŸ¥è¯†æç¤º

**å¥¥å¡å§†å‰ƒåˆ€ (Occam's Razor / ANM)**ï¼š
åœ¨æ­¤ä»»åŠ¡ä¸­ï¼Œ**â€œç®€å•â€æ„å‘³ç€èƒ½æœ€å¥½åœ°è§£é‡Šæ•°æ®**ã€‚
- ä¸è¦å› ä¸ºä¸€ä¸ªæ¨¡å‹æ˜¯çº¿æ€§çš„ï¼ˆLinearï¼‰å°±è®¤ä¸ºå®ƒæ›´â€œç®€å•â€ã€‚å¦‚æœå®ƒæ‹Ÿåˆå¾—å¾ˆå·®ï¼ˆLow RÂ²ï¼‰ä¸”æ®‹å·®ä¸ç‹¬ç«‹ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ª**é”™è¯¯**çš„ç®€åŒ–æ¨¡å‹ã€‚
- ç›¸åï¼Œå¦‚æœä¸€ä¸ªéçº¿æ€§æ¨¡å‹ï¼ˆå¦‚å¤šé¡¹å¼ï¼‰èƒ½å®Œç¾æ‹Ÿåˆæ•°æ®ä¸”æ®‹å·®å¦‚ç™½å™ªå£°èˆ¬ç‹¬ç«‹ï¼Œé‚£ä¹ˆå®ƒæ‰æ˜¯**æ­£ç¡®**çš„å› æœæœºåˆ¶ã€‚
- **æ³•åˆ™**ï¼šä¼˜å…ˆé€‰æ‹©æ‹Ÿåˆåº¦ (RÂ²) æ›´é«˜ä¸”æ®‹å·®ç‹¬ç«‹æ€§ (Mutual Information) æ›´å¥½çš„æ–¹å‘ï¼Œæ— è®ºå®ƒæ˜¯çº¿æ€§çš„è¿˜æ˜¯éçº¿æ€§çš„ã€‚

**LiNGAM åŸç† (Non-Gaussianity)**ï¼š
1. å¦‚æœçœŸå®æœºåˆ¶æ˜¯ A->Bï¼Œé‚£ä¹ˆæ­£å‘æ‹Ÿåˆçš„æ®‹å·®ä¼šæ¯”åå‘æ‹Ÿåˆæ›´ç‹¬ç«‹äºè¾“å…¥ã€‚
2. **ååº¦ (Skewness)** æ˜¯éé«˜æ–¯æ€§çš„é‡è¦æ ‡å¿—ã€‚å¦‚æœå› å˜é‡é«˜åº¦åæ–œï¼ˆå¦‚æŒ‡æ•°åˆ†å¸ƒï¼‰ï¼Œè¿™æä¾›äº†å¾ˆå¼ºçš„å¯è¯†åˆ«æ€§ä¿¡å·ã€‚

**æ®‹å·®ç¨³å®šæ€§ (Heteroscedasticity)**ï¼š
å¦‚æœä¸€ä¸ªæ–¹å‘çš„æ®‹å·®æ–¹å·®éšè¾“å…¥å‰§çƒˆæ³¢åŠ¨ï¼ˆå¼‚æ–¹å·®ï¼‰ï¼Œè€Œå¦ä¸€ä¸ªæ–¹å‘ç¨³å®šï¼Œ**ç¨³å®šæ–¹å‘**é€šå¸¸æ˜¯æ­£ç¡®çš„åŸå› ã€‚

**æ··æ‚å› ç´ è¿¹è±¡**ï¼šå¦‚æœä¸¤ä¸ªæ–¹å‘çš„æ®‹å·®éƒ½å¾ˆå¹²å‡€ï¼Œä¸”ç›¸å…³æ€§æå¼ºï¼Œå¯èƒ½å­˜åœ¨ç¬¬ä¸‰å˜é‡ã€‚

è¯·ä»¥ç»“æ„åŒ–çš„ JSON æ ¼å¼è¿”å›ä½ çš„æ¨ç†ç»“æœã€‚
"""

SIMPLE_PROMPT = """åŸºäºä»¥ä¸‹ç»Ÿè®¡åˆ†æï¼Œåˆ¤æ–­å˜é‡ A å’Œ B ä¹‹é—´çš„å› æœå…³ç³»ï¼š

{narrative}

è¯·è¿”å› JSON æ ¼å¼çš„æ¨ç†ç»“æœï¼ŒåŒ…æ‹¬ï¼šdirectionï¼ˆå› æœæ–¹å‘ï¼‰ã€confidenceï¼ˆç½®ä¿¡åº¦ï¼‰ã€reasoning_chainï¼ˆæ¨ç†è¿‡ç¨‹ï¼‰ã€‚
"""

ABLATION_PROMPT_RESIDUAL_ONLY = """ä½ æ˜¯ä¸€ä½ç»Ÿè®¡å­¦å®¶ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªåŒ¿åå˜é‡çš„æ®‹å·®åˆ†æç»“æœï¼š

{narrative}

**ä»…åŸºäºæ®‹å·®ç‹¬ç«‹æ€§**ï¼Œåˆ¤æ–­å› æœæ–¹å‘ã€‚è¿”å› JSON æ ¼å¼ç»“æœã€‚
"""

def get_prompt(template_name: str = "sherlock", narrative: str = "") -> str:
    """
    è·å–æŒ‡å®šçš„ Prompt æ¨¡æ¿
    
    Parameters:
    -----------
    template_name : str
        æ¨¡æ¿åç§°ï¼š'sherlock', 'simple', 'residual_only'
    narrative : str
        æ¥è‡ª StatTranslator çš„ç»Ÿè®¡å™äº‹
    
    Returns:
    --------
    str : å®Œæ•´çš„ prompt
    """
    templates = {
        'sherlock': SHERLOCK_HOLMES_PROMPT,
        'simple': SIMPLE_PROMPT,
        'residual_only': ABLATION_PROMPT_RESIDUAL_ONLY
    }
    
    template = templates.get(template_name, SHERLOCK_HOLMES_PROMPT)
    return template.format(narrative=narrative)
